#summary One-sentence summary of this page.
#labels Phase-Support
bbs sites constantly update their doms ( because their site engine or structure is that poor )
this is some steps we do to fix the site change today


= Introduction =
*PY FILE GOES HERE*

""" 
#PATCH ON SJTU V2 - lefted guidance
#GET PATTERN LINE USING REPR
#PRINCIPAL NO.1 YOU CAN FORMAT THE DOM WHEN YOU OBSERVE,BUT WHEN YOU HANLE IT TO MACHINE, PLEASE KEEP IT <B>ORGINAL</B>

pattern = '<td valign="middle"><font color="#FFFFFF"><img src="iconT.gif"> <b>.*?</b></font></td>\n                                </tr>\n                \t\t</table>\n                \t</td>\n                  </tr>.*?</table>'
htmlstring = urllib2.urlopen('http://bbs.sjtu.edu.cn/php/bbsindex.html').read();
htmlstring = unicode(htmlstring, 'GBK', 'ignore').encode('UTF-8');
blockstring = re.search(pattern,htmlstring,re.DOTALL).group();
print blockstring;
"""
##PATCH ON FDU V2
url = "http://www.lilacbbs.com/"
#PRINCIPAL NO.2 YOU MAY NEED DOM STRUCTURE TO HELP YOU DETERMINE RE EXPRESSION"
pattern = """<div id="portal_block_302_content" class="content">.*?</div>"""
htmlstring = urllib2.urlopen(url).read();
htmlstring = unicode(htmlstring, 'GBK', 'ignore').encode('UTF-8');

blockstring = re.search(pattern,htmlstring,re.DOTALL).group();
print blockstring;

= Details =

*the fix details goes here and large html content are simply neglected*
#original status
<SPAN class=titletext style="FONT-SIZE: 14px; MARGIN-LEFT: 80px; COLOR: #ffffff">十大热门</SPAN></DIV><div id="portal_block_302_content" class="content"><div class="module cl xl">
<ul><li>
	<dl class="cl xld">
		<dt><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=76607" title="宝宝" target="_blank">宝宝</a></dt>
		<dd>好可爱的娃,好可爱的娃,好可爱的娃。好可爱的娃。好可爱的娃。


</dd>
	</dl> 
	<hr class="da" />
</li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=103882" title="找男生朋友" target="_blank">找男生朋友</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245012" title="紫丁香社区使用帮助及功能调整报告" target="_blank">紫丁香社区使用帮助及功能调整报告</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=106883" title="发一张小LOLI的照片（已被父母授权）" target="_blank">发一张小LOLI的照片（已被父母授权）</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245230" title="当忠内看见主公是孙权就头疼" target="_blank">当忠内看见主公是孙权就头疼</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245107" title="寻一个他" target="_blank">寻一个他</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245376" title="老汉洗浴中心泡澡 “泡”丢一睾丸" target="_blank">老汉洗浴中心泡澡 “泡”丢一睾丸</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=102603" title="Cliff812系钓鱼者，请大家警惕！" target="_blank">Cliff812系钓鱼者，请大家警惕！</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245307" title="替老乡征个男友" target="_blank">替老乡征个男友</a></li><li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245466" title="如果你发现" target="_blank">如果你发现</a></li></ul>

</div></div></div><div id="portal_block_316" class="block move-span">

#--> formatted
<SPAN class=titletext style="FONT-SIZE: 14px; MARGIN-LEFT: 80px; COLOR: #ffffff">十大热门</SPAN>
</DIV><div id="portal_block_302_content" class="content"><div class="module cl xl">
<ul><li><dl class="cl xld">
<dt><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=76607" title="宝宝" target="_blank">宝宝</a></dt>
<dd>好可爱的娃,好可爱的娃,好可爱的娃。好可爱的娃。好可爱的娃</dd>
</dl><hr class="da" /></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=103882" title="找男生朋友" target="_blank">找男生朋友</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245012" title="紫丁香社区使用帮助及功能调整报告" target="_blank">紫丁香社区使用帮助及功能调整报告</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=106883" title="发一张小LOLI的照片（已被父母授权）" target="_blank">发一张小LOLI的照片（已被父母授权）</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245230" title="当忠内看见主公是孙权就头疼" target="_blank">当忠内看见主公是孙权就头疼</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245107" title="寻一个他" target="_blank">寻一个他</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245376" title="老汉洗浴中心泡澡 “泡”丢一睾丸" target="_blank">老汉洗浴中心泡澡 “泡”丢一睾丸</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=102603" title="Cliff812系钓鱼者，请大家警惕！" target="_blank">Cliff812系钓鱼者，请大家警惕！</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245307" title="替老乡征个男友" target="_blank">替老乡征个男友</a></li>
    <li><a href="http://www.lilacbbs.com/forum.php?mod=viewthread&tid=245466" title="如果你发现" target="_blank">如果你发现</a></li>
    </ul>
</div>

<li><a href="$link" title="$title" target="_blank">*</a></li>

<SPAN class=titletext style="FONT-SIZE: 14px; MARGIN-LEFT: 80px; COLOR: #ffffff">十大热门</SPAN>
</DIV><div id="portal_block_302_content" class="content"><div class="module cl xl">.*?
</div></div></div><div id="portal_block_316" class="block move-span">

<hr class="da" />

</div>

#1
"""<SPAN class=titletext style="FONT-SIZE: 14px; MARGIN-LEFT: 80px; COLOR: #ffffff">十大热门</SPAN></DIV><div id="portal_block_302_content" class="content"><div class="module cl xl">
<ul>.*?</ul>"""
#2
"""<hr class="da" />.*?

</div>"""
#3
"""
<SPAN class=titletext style="FONT-SIZE: 14px; MARGIN-LEFT: 80px; COLOR: #ffffff">十大热门</SPAN></DIV><div id="portal_block_302_content" class="content"><div class="module cl xl">
.*?<div id="portal_block_316" class="block move-span">"""
#4 after inspecting using firebug tried dom ----!!! it worked
"""<div id="portal_block_302_content" class="content">.*?</div>"""

#new problems broughted about
1. scraped infomation are seemingly more instructed, info structure should be improved or restructure or abstracted
-->stormed: store these infomation in serialized dict would be better choice, missed keys could be restored by default values.
-->integrated with site framework redone. maybe in the next two versions.
2. the parser engine should be improved to report site structure changes(only structure change) and site inavailabe for long time.
!important.


